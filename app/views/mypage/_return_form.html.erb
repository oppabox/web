<!-- order description -->  
<div class="row">
  <p>
    <span style="font-size:20px"><b><%= @order.item.display_name %></b></span>&nbsp;
    <span>[<%= @options.join(", ") %>]</span>
  </p>
  <p> <%= t('purchase_date') %>: &nbsp;
   <%= @order.purchase.approval_datetime.nil? ? '' : @order.purchase.approval_datetime.strftime("%F") %>
  </p>
</div>
<input type="hidden" id="order_id" value="<%= @order.id %>">
<div class="row">
  <h4><b><%= t('sellect_quantity') %></b></h4>
  <table class="table">
    <thead>
      <tr class="active">
        <th class="text-center"><%= t("product_info") %></th>
        <th class="text-center"><%= t("total_payment_billing_price") %></th>
        <th class="text-center"><%= t("return_quantity") %></th>
        <th class="text-center"><%= t("return_amount") %></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td class="text-center"><%= @order.item.display_name + ' / #' + @order.quantity.to_s %></td>
        <td class="text-center"><%= Order.change_currency(@order.total_price * @order.quantity) %></td>
        <td class="text-center">
          <% opt = Array.new %>
          <% for i in 0..@order.quantity do %>
            <% opt[i] = i %>
          <% end %>
          <%= select_tag "return_quantity", options_for_select(opt, 0), :autofocus => 'true' %>
        </td>
        <td class="text-center return_amount"><%= Order.change_currency(0) %></td>
      </tr>
    </tbody>
  </table>
</div>

<div class="row">
  <h4><b><%= t('details') %></b></h4>
  <table class="table">
    <tbody>
      <tr>
        <th class="active"><%= t('reason_for_return') %></th>
        <td>
          <div class="form-group">
            <%= select_tag "return_reason", options_for_select(Return::REASONS.invert.keys.collect { |x| t(x) }, 0 ), { :class => 'form-control input-sm' } %>
          </div>
          <div class="form-group">
            <%= text_area_tag "return_reason_details", nil, size: "100x5", class: 'form-control' ,placeholder: t('return_reason_plh') %>
          </div>
        </td>
      </tr>
      <tr>
        <th class="active"><%= t('collect_address') %></th>
        <td>
          <p><%= t('collect_txt1') %>
            <small><%= t('collect_txt2') %></small>
          </p>
          <%=render partial: "/home/user_detail_info_modify" %>

        </td>
      </tr>
    </tbody>
  </table>
</div>

<div class="row">
  <h4><b><%= t('refund_info') %></b></h4>
  <table class="table">
    <tbody>
      <tr>
        <th class="active"><%= t('return_amount_our_duty') %></th>
        <td class="return_amount"><%= Order.change_currency(0) %></td>
      </tr>
      <tr>
        <th class="active"><%= t('shipping') %></th>
        <td id="return_shipping"><%= Order.change_currency(0) %></td>
      </tr>
      <tr>
        <th class="active"><%= t('return_amount_customer_duty') %></th>
        <td id="return_actual_amount"><%= Order.change_currency(0) %></td>
      </tr>
    </tbody>
  </table>
</div>

<div class="row text-center">
  <button class="btn btn-lg btn-default" onclick="history.back()"><%= t('request_back') %></button>
  <button class="btn btn-lg btn-danger" id="return_request_button" name="commit"><%= t('type_return') %></button>
</div>






<script>
// Recipient -> Sender
$(document).ready(function(){
  $('#recipient_label').html("<%= t('js_sender') %>")
})

$('#return_quantity').change(function(){
  amount = $(this).val()
  price = <%= @order.total_price %>
  $.ajax({
    url: "/mypage/change_currency/",
    type: "POST",
    dataType:"JSON",
    data: {
      order_id: <%= @order.id %>,
      amount: amount * price
    },
    success: function(data) {
      $('.return_amount').html(data['cancel_amount'])
      $('#return_shipping').html(data['shipping'])
      $('#return_actual_amount').html(data['actual_amount'])
    }
  })
})
</script>